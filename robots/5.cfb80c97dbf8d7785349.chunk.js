webpackJsonp([5,20],{1147:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(1),c=s&&s.__esModule?function(){return s["default"]}:function(){return s};n.d(c,"a",c);var u=n(53),l=u&&u.__esModule?function(){return u["default"]}:function(){return u};n.d(l,"a",l);var a=n(114),p=n(1237),f=p&&p.__esModule?function(){return p["default"]}:function(){return p};n.d(f,"a",f);var h=n(1205),d=n(1215),m=n(1217);n.d(e,"TestPage",function(){return y});var b=function(){var t="function"==typeof Symbol&&Symbol["for"]&&Symbol["for"]("react.element")||60103;return function(e,n,o,i){var r=e&&e.defaultProps,s=arguments.length-3;if(n||0===s||(n={}),n&&r)for(var c in r)void 0===n[c]&&(n[c]=r[c]);else n||(n=r||{});if(1===s)n.children=i;else if(s>1){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+3];n.children=u}return{$$typeof:t,type:e,key:void 0===o?null:""+o,ref:null,props:n,_owner:null}}}(),g=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),y=function(t){function e(){return o(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return r(e,t),g(e,[{key:"render",value:function(){return b("div",{className:f.a.testWrapper},void 0,b("div",{className:f.a.testPage},void 0,b(h.a,{messages:this.props.messages,ids:this.props.ids})))}}]),e}(c.a.Component),v=n.i(a.b)({messages:n.i(m.a)(),ids:n.i(m.b)()});e["default"]=n.i(u.connect)(v,d)(y)},1168:function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return i});var o="app/ChatBox/SET_CHATROOM_ID",i="app/ChatBox/RECEIVE_MESSAGE"},1198:function(t,e,n){(function(t){(function(){var e=[].slice;this.ActionCable={INTERNAL:{message_types:{welcome:"welcome",ping:"ping",confirmation:"confirm_subscription",rejection:"reject_subscription"},default_mount_path:"/cable",protocols:["actioncable-v1-json","actioncable-unsupported"]},createConsumer:function(t){var e;return null==t&&(t=null!=(e=this.getConfig("url"))?e:this.INTERNAL.default_mount_path),new ActionCable.Consumer(this.createWebSocketURL(t))},getConfig:function(t){var e;return e=document.head.querySelector("meta[name='action-cable-"+t+"']"),null!=e?e.getAttribute("content"):void 0},createWebSocketURL:function(t){var e;return t&&!/^wss?:/i.test(t)?(e=document.createElement("a"),e.href=t,e.href=e.href,e.protocol=e.protocol.replace("http","ws"),e.href):t},startDebugging:function(){return this.debugging=!0},stopDebugging:function(){return this.debugging=null},log:function(){var t;if(t=1<=arguments.length?e.call(arguments,0):[],this.debugging)return t.push(Date.now()),console.log.apply(console,["[ActionCable]"].concat(e.call(t)))}},"undefined"!=typeof window&&null!==window&&(window.ActionCable=this.ActionCable),"undefined"!=typeof t&&null!==t&&(t.exports=this.ActionCable)}).call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};ActionCable.ConnectionMonitor=function(){function e(e){this.connection=e,this.visibilityDidChange=t(this.visibilityDidChange,this),this.reconnectAttempts=0}var n,o,i;return e.pollInterval={min:3,max:30},e.staleThreshold=6,e.prototype.start=function(){if(!this.isRunning())return this.startedAt=o(),delete this.stoppedAt,this.startPolling(),document.addEventListener("visibilitychange",this.visibilityDidChange),ActionCable.log("ConnectionMonitor started. pollInterval = "+this.getPollInterval()+" ms")},e.prototype.stop=function(){if(this.isRunning())return this.stoppedAt=o(),this.stopPolling(),document.removeEventListener("visibilitychange",this.visibilityDidChange),ActionCable.log("ConnectionMonitor stopped")},e.prototype.isRunning=function(){return null!=this.startedAt&&null==this.stoppedAt},e.prototype.recordPing=function(){return this.pingedAt=o()},e.prototype.recordConnect=function(){return this.reconnectAttempts=0,this.recordPing(),delete this.disconnectedAt,ActionCable.log("ConnectionMonitor recorded connect")},e.prototype.recordDisconnect=function(){return this.disconnectedAt=o(),ActionCable.log("ConnectionMonitor recorded disconnect")},e.prototype.startPolling=function(){return this.stopPolling(),this.poll()},e.prototype.stopPolling=function(){return clearTimeout(this.pollTimeout)},e.prototype.poll=function(){return this.pollTimeout=setTimeout(function(t){return function(){return t.reconnectIfStale(),t.poll()}}(this),this.getPollInterval())},e.prototype.getPollInterval=function(){var t,e,o,i;return i=this.constructor.pollInterval,o=i.min,e=i.max,t=5*Math.log(this.reconnectAttempts+1),Math.round(1e3*n(t,o,e))},e.prototype.reconnectIfStale=function(){if(this.connectionIsStale())return ActionCable.log("ConnectionMonitor detected stale connection. reconnectAttempts = "+this.reconnectAttempts+", pollInterval = "+this.getPollInterval()+" ms, time disconnected = "+i(this.disconnectedAt)+" s, stale threshold = "+this.constructor.staleThreshold+" s"),this.reconnectAttempts++,this.disconnectedRecently()?ActionCable.log("ConnectionMonitor skipping reopening recent disconnect"):(ActionCable.log("ConnectionMonitor reopening"),this.connection.reopen())},e.prototype.connectionIsStale=function(){var t;return i(null!=(t=this.pingedAt)?t:this.startedAt)>this.constructor.staleThreshold},e.prototype.disconnectedRecently=function(){return this.disconnectedAt&&i(this.disconnectedAt)<this.constructor.staleThreshold},e.prototype.visibilityDidChange=function(){if("visible"===document.visibilityState)return setTimeout(function(t){return function(){if(t.connectionIsStale()||!t.connection.isOpen())return ActionCable.log("ConnectionMonitor reopening stale connection on visibilitychange. visbilityState = "+document.visibilityState),t.connection.reopen()}}(this),200)},o=function(){return(new Date).getTime()},i=function(t){return(o()-t)/1e3},n=function(t,e,n){return Math.max(e,Math.min(n,t))},e}()}.call(this),function(){var t,e,n,o,i,r,s=[].slice,c=function(t,e){return function(){return t.apply(e,arguments)}},u=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};o=ActionCable.INTERNAL,e=o.message_types,n=o.protocols,i=2<=n.length?s.call(n,0,t=n.length-1):(t=0,[]),r=n[t++],ActionCable.Connection=function(){function t(t){this.consumer=t,this.open=c(this.open,this),this.subscriptions=this.consumer.subscriptions,this.monitor=new ActionCable.ConnectionMonitor(this),this.disconnected=!0}return t.reopenDelay=500,t.prototype.send=function(t){return!!this.isOpen()&&(this.webSocket.send(JSON.stringify(t)),!0)},t.prototype.open=function(){if(this.isActive())throw ActionCable.log("Attempted to open WebSocket, but existing socket is "+this.getState()),new Error("Existing connection must be closed before opening");return ActionCable.log("Opening WebSocket, current state is "+this.getState()+", subprotocols: "+n),null!=this.webSocket&&this.uninstallEventHandlers(),this.webSocket=new WebSocket(this.consumer.url,n),this.installEventHandlers(),this.monitor.start(),!0},t.prototype.close=function(t){var e,n;if(e=(null!=t?t:{allowReconnect:!0}).allowReconnect,e||this.monitor.stop(),this.isActive())return null!=(n=this.webSocket)?n.close():void 0},t.prototype.reopen=function(){var t,e;if(ActionCable.log("Reopening WebSocket, current state is "+this.getState()),!this.isActive())return this.open();try{return this.close()}catch(e){return t=e,ActionCable.log("Failed to reopen WebSocket",t)}finally{ActionCable.log("Reopening WebSocket in "+this.constructor.reopenDelay+"ms"),setTimeout(this.open,this.constructor.reopenDelay)}},t.prototype.getProtocol=function(){var t;return null!=(t=this.webSocket)?t.protocol:void 0},t.prototype.isOpen=function(){return this.isState("open")},t.prototype.isActive=function(){return this.isState("open","connecting")},t.prototype.isProtocolSupported=function(){var t;return t=this.getProtocol(),u.call(i,t)>=0},t.prototype.isState=function(){var t,e;return e=1<=arguments.length?s.call(arguments,0):[],t=this.getState(),u.call(e,t)>=0},t.prototype.getState=function(){var t,e,n;for(e in WebSocket)if(n=WebSocket[e],n===(null!=(t=this.webSocket)?t.readyState:void 0))return e.toLowerCase();return null},t.prototype.installEventHandlers=function(){var t,e;for(t in this.events)e=this.events[t].bind(this),this.webSocket["on"+t]=e},t.prototype.uninstallEventHandlers=function(){var t;for(t in this.events)this.webSocket["on"+t]=function(){}},t.prototype.events={message:function(t){var n,o,i,r;if(this.isProtocolSupported())switch(i=JSON.parse(t.data),n=i.identifier,o=i.message,r=i.type){case e.welcome:return this.monitor.recordConnect(),this.subscriptions.reload();case e.ping:return this.monitor.recordPing();case e.confirmation:return this.subscriptions.notify(n,"connected");case e.rejection:return this.subscriptions.reject(n);default:return this.subscriptions.notify(n,"received",o)}},open:function(){if(ActionCable.log("WebSocket onopen event, using '"+this.getProtocol()+"' subprotocol"),this.disconnected=!1,!this.isProtocolSupported())return ActionCable.log("Protocol is unsupported. Stopping monitor and disconnecting."),this.close({allowReconnect:!1})},close:function(t){if(ActionCable.log("WebSocket onclose event"),!this.disconnected)return this.disconnected=!0,this.monitor.recordDisconnect(),this.subscriptions.notifyAll("disconnected",{willAttemptReconnect:this.monitor.isRunning()})},error:function(){return ActionCable.log("WebSocket onerror event")}},t}()}.call(this),function(){var t=[].slice;ActionCable.Subscriptions=function(){function e(t){this.consumer=t,this.subscriptions=[]}return e.prototype.create=function(t,e){var n,o,i;return n=t,o="object"==typeof n?n:{channel:n},i=new ActionCable.Subscription(this.consumer,o,e),this.add(i)},e.prototype.add=function(t){return this.subscriptions.push(t),this.consumer.ensureActiveConnection(),this.notify(t,"initialized"),this.sendCommand(t,"subscribe"),t},e.prototype.remove=function(t){return this.forget(t),this.findAll(t.identifier).length||this.sendCommand(t,"unsubscribe"),t},e.prototype.reject=function(t){var e,n,o,i,r;for(o=this.findAll(t),i=[],e=0,n=o.length;e<n;e++)r=o[e],this.forget(r),this.notify(r,"rejected"),i.push(r);return i},e.prototype.forget=function(t){var e;return this.subscriptions=function(){var n,o,i,r;for(i=this.subscriptions,r=[],n=0,o=i.length;n<o;n++)e=i[n],e!==t&&r.push(e);return r}.call(this),t},e.prototype.findAll=function(t){var e,n,o,i,r;for(o=this.subscriptions,i=[],e=0,n=o.length;e<n;e++)r=o[e],r.identifier===t&&i.push(r);return i},e.prototype.reload=function(){var t,e,n,o,i;for(n=this.subscriptions,o=[],t=0,e=n.length;t<e;t++)i=n[t],o.push(this.sendCommand(i,"subscribe"));return o},e.prototype.notifyAll=function(){var e,n,o,i,r,s,c;for(n=arguments[0],e=2<=arguments.length?t.call(arguments,1):[],r=this.subscriptions,s=[],o=0,i=r.length;o<i;o++)c=r[o],s.push(this.notify.apply(this,[c,n].concat(t.call(e))));return s},e.prototype.notify=function(){var e,n,o,i,r,s,c;for(s=arguments[0],n=arguments[1],e=3<=arguments.length?t.call(arguments,2):[],c="string"==typeof s?this.findAll(s):[s],r=[],o=0,i=c.length;o<i;o++)s=c[o],r.push("function"==typeof s[n]?s[n].apply(s,e):void 0);return r},e.prototype.sendCommand=function(t,e){var n;return n=t.identifier,this.consumer.send({command:e,identifier:n})},e}()}.call(this),function(){ActionCable.Subscription=function(){function t(t,n,o){this.consumer=t,null==n&&(n={}),this.identifier=JSON.stringify(n),e(this,o)}var e;return t.prototype.perform=function(t,e){return null==e&&(e={}),e.action=t,this.send(e)},t.prototype.send=function(t){return this.consumer.send({command:"message",identifier:this.identifier,data:JSON.stringify(t)})},t.prototype.unsubscribe=function(){return this.consumer.subscriptions.remove(this)},e=function(t,e){var n,o;if(null!=e)for(n in e)o=e[n],t[n]=o;return t},t}()}.call(this),function(){ActionCable.Consumer=function(){function t(t){this.url=t,this.subscriptions=new ActionCable.Subscriptions(this),this.connection=new ActionCable.Connection(this)}return t.prototype.send=function(t){return this.connection.send(t)},t.prototype.connect=function(){return this.connection.open()},t.prototype.disconnect=function(){return this.connection.close({allowReconnect:!1})},t.prototype.ensureActiveConnection=function(){if(!this.connection.isActive())return this.connection.open()},t}()}.call(this)}).call(e,n(98)(t))},1204:function(t,e,n){"use strict";function o(t){return{type:r.a,chatroomId:t}}function i(t){return{type:r.b,message:t,id:t.id}}var r=n(1168);e.setChatroomId=o,e.receiveMessage=i},1205:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(1),c=s&&s.__esModule?function(){return s["default"]}:function(){return s};n.d(c,"a",c);var u=n(53),l=u&&u.__esModule?function(){return u["default"]}:function(){return u};n.d(l,"a",l);var a=n(114),p=n(1232),f=p&&p.__esModule?function(){return p["default"]}:function(){return p};n.d(f,"a",f);var h=n(1198),d=h&&h.__esModule?function(){return h["default"]}:function(){return h};n.d(d,"a",d);var m=n(1204),b=function(){var t="function"==typeof Symbol&&Symbol["for"]&&Symbol["for"]("react.element")||60103;return function(e,n,o,i){var r=e&&e.defaultProps,s=arguments.length-3;if(n||0===s||(n={}),n&&r)for(var c in r)void 0===n[c]&&(n[c]=r[c]);else n||(n=r||{});if(1===s)n.children=i;else if(s>1){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+3];n.children=u}return{$$typeof:t,type:e,key:void 0===o?null:""+o,ref:null,props:n,_owner:null}}}(),g=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),y=function(t){function e(t){o(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.submitMsg=n.submitMsg.bind(n),n}return r(e,t),g(e,[{key:"componentDidMount",value:function(){var t=this;this.cable=d.a.createConsumer("ws://localhost:4000/cable"),this.subscription=this.cable.subscriptions.create("ChatroomsChannel",{received:function(e){t.props.receiveMessage(e.message)}})}},{key:"componentDidUpdate",value:function(){var t=this._messages;t.scrollTop=t.scrollHeight}},{key:"componentWillUnmount",value:function(){this.cable.subscriptions.remove(this.subscription)}},{key:"submitMsg",value:function(t){13===t.keyCode&&(this.subscription.send({chatroom_id:1,body:this._input.value}),this._input.value="")}},{key:"render",value:function(){var t=this;return b("div",{className:f.a.chatBox},void 0,c.a.createElement("div",{ref:function(e){t._messages=e},className:f.a.messageWrapper},b("div",{className:f.a.messages},void 0,this.props.ids.map(function(e,n){return b("div",{className:f.a.message+" "+(n%2===0?f.a.myMessage:f.a.theirMessage)},n,t.props.messages[e].body)}))),b("div",{className:f.a.input},void 0,c.a.createElement("input",{ref:function(e){t._input=e},onKeyUp:this.submitMsg})))}}]),e}(c.a.Component),v=n.i(a.b)({});e.a=n.i(u.connect)(v,m)(y)},1215:function(t,e,n){"use strict";function o(){return{type:i.a}}var i=n(1216);e.defaultAction=o},1216:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o="app/TestPage/DEFAULT_ACTION"},1217:function(t,e,n){"use strict";var o=n(114);n.d(e,"a",function(){return r}),n.d(e,"b",function(){return s});var i=function(){return function(t){return t.get("testPage")}},r=function(){return n.i(o.a)(i(),function(t){return t.get("messages").toJS()})},s=function(){return n.i(o.a)(i(),function(t){return t.get("ids").toJS()})}},1222:function(t,e,n){e=t.exports=n(1132)(),e.push([t.i,".SLlJFXYEVaPt7ZtF27Jdo{max-width:800px;-ms-flex:1;flex:1;-ms-flex-preferred-size:100%;flex-basis:100%;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:end;align-items:flex-end;background:#fff;font-family:HelveticaNeue-Light,Helvetica Neue Light,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif;font-weight:300;-ms-flex-item-align:center;align-self:center;margin-bottom:10px}._1kxwghndps6_qSZLTmNNHD,.SLlJFXYEVaPt7ZtF27Jdo{width:100%;display:-ms-flexbox;display:flex;max-height:calc(100vh - 148px)}._1kxwghndps6_qSZLTmNNHD{-ms-flex:1;flex:1;font-size:20px;overflow-y:auto}::-webkit-scrollbar{display:none}.Dlls-04KEJZxAtXGCumRn{padding:5px 5px 0;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:end;justify-content:flex-end}._1P6fpp1NDT5sA0v41bjlPq,.Dlls-04KEJZxAtXGCumRn{min-height:-webkit-min-content;min-height:-moz-min-content;min-height:min-content;display:-ms-flexbox;display:flex;word-wrap:break-word}._1P6fpp1NDT5sA0v41bjlPq{margin-bottom:3px;margin-top:0;max-width:80%;padding:10px;border-radius:15px;word-break:break-word;line-height:1.6em}._3vS6hzBKO22DUtH3pWIPmb{background:blue;margin-left:auto;color:#fff}._1jz1tsjByQ7iwcJ-yA1iKL{background-color:#d7d7d7;margin-right:auto}input{width:99%;height:30px;font-size:20px}.tNu3h9MxjpeKS_oSAH1hp{display:-ms-flexbox;display:flex;border-top:3px solid gray;-ms-flex-pack:center;justify-content:center;width:100%}",""]),e.locals={chatBox:"SLlJFXYEVaPt7ZtF27Jdo",messageWrapper:"_1kxwghndps6_qSZLTmNNHD",messages:"Dlls-04KEJZxAtXGCumRn",message:"_1P6fpp1NDT5sA0v41bjlPq",myMessage:"_3vS6hzBKO22DUtH3pWIPmb",theirMessage:"_1jz1tsjByQ7iwcJ-yA1iKL",input:"tNu3h9MxjpeKS_oSAH1hp"}},1227:function(t,e,n){e=t.exports=n(1132)(),e.push([t.i,"._3o8BHhwhmifXLg48S4-9mK{-ms-flex-pack:end;justify-content:flex-end;padding:0 5px;-ms-flex-direction:column;flex-direction:column}._3c_XJgQ6uADN2b4RfmNyq2,._3o8BHhwhmifXLg48S4-9mK{-ms-flex-positive:1;flex-grow:1;display:-ms-flexbox;display:flex}",""]),e.locals={testPage:"_3o8BHhwhmifXLg48S4-9mK",testWrapper:"_3c_XJgQ6uADN2b4RfmNyq2"}},1232:[1272,1222],1237:[1272,1227],1272:function(t,e,n,o){var i=n(o);"string"==typeof i&&(i=[[t.i,i,""]]),n(1133)(i,{}),i.locals&&(t.exports=i.locals)}});